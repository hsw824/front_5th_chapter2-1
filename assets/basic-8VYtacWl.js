import"./modulepreload-polyfill-B5Qt9EMX.js";const _={OUT_OF_STOCK:"재고가 부족합니다."},i=(e,n)=>{const t=document.createElement(e);return Object.keys(n).forEach(o=>{t[o]=n[o]}),t},b=()=>{const e=new Set;return{subscribe:s=>e.add(s),notify:()=>e.forEach(s=>s())}},N=(e,n)=>{const{subscribe:t,notify:s}=b();let o={...e};const c=u=>{o={...o,...u},s()},r=()=>({...o});let a;return a=null,{getState:r,setState:c,subscribe:t,actions:a}},R=[{id:"p1",name:"상품1",price:1e4,quantity:50},{id:"p2",name:"상품2",price:2e4,quantity:30},{id:"p3",name:"상품3",price:3e4,quantity:20},{id:"p4",name:"상품4",price:15e3,quantity:0},{id:"p5",name:"상품5",price:25e3,quantity:10}],l=N({prodList:R,totalAmount:0,itemCount:0,lastSelectedItemId:"p1"}),v=()=>{const{getState:e}=l,{totalAmount:n}=e(),t=document.getElementById("cart-total");if(!t)return;const s=Math.floor(n/1e3);let o=document.getElementById("loyalty-points");o||(o=i("span",{id:"loyalty-points",className:"text-blue-500 ml-2"}),t.appendChild(o)),o.textContent=`(포인트: ${s}) `},q=e=>e>0?`재고 부족 ( ${e} 개 남음)`:"품절";function M(){const{prodList:e}=l.getState(),n=document.getElementById("stock-status");if(!n)return;let t="";e.forEach(s=>{s.quantity>=5||(t+=`${s.name}: ${q(s.quantity)} 
`)}),n.textContent=t}const S={FLASH_TIME:Math.random()*1e4,FLASH_INTERVAL:3e4,SUGGEST_TIME:Math.random()*2e4,SUGGEST_INTERVAL:6e4},O={FLASH:.8,SUGGEST:.95},B=Math.random()<.3,d={FULL_PRICE_RATIO:1,ITEM_RATIO:{p1:.1,p2:.15,p3:.2,p4:.05,p5:.25},FOR_MIN_QUANTITY:10,BULK_DISCOUNT:{QUANTITY:30,RATIO:.25},TUESDAY_RATIO:.1},$=()=>new Date().getDay()===2,g=()=>{const{getState:e,setState:n}=l,{prodList:t}=e(),s=document.getElementById("cart-items"),o=document.getElementById("cart-total"),c=document.getElementById("stock-status");if(!s||!o||!c)return;const r=Array.from(s.children);let a=0,u=0,p=0;r.forEach(I=>{const y=t.find(U=>U.id===I.id),T=parseInt(I.querySelector("span").textContent.split("x ")[1]),x=y.price*T;let C=0;u+=T,p+=x,T>=d.FOR_MIN_QUANTITY&&(C=d.ITEM_RATIO[y.id]),a+=x*(d.FULL_PRICE_RATIO-C)});let m=0;if(u>=d.BULK_DISCOUNT.QUANTITY){const I=a*d.BULK_DISCOUNT.RATIO,y=p-a;I>y?(a=p*(d.FULL_PRICE_RATIO-d.BULK_DISCOUNT.RATIO),m=d.BULK_DISCOUNT.RATIO):m=(p-a)/p}else m=(p-a)/p;if($()&&(a*=d.FULL_PRICE_RATIO-d.TUESDAY_RATIO,m=Math.max(m,d.TUESDAY_RATIO)),n({totalAmount:a,itemCount:u}),o.textContent=`총액: ${Math.round(a)}원`,m>0){const I=i("span",{className:"text-green-500 ml-2",textContent:`(${(m*100).toFixed(1)}% 할인 적용)`});o.appendChild(I)}M(),v()},{getState:w,setState:E}=l,{prodList:h}=w(),F=(e,n)=>{const t=parseInt(e.querySelector("span").textContent.split("x ")[1])+1;if(t<=n.quantity){e.querySelector("span").textContent=`${n.name} - ${n.price}원 x ${t}`,n.quantity--;const s=h.map(o=>o.id===n.id?n:o);E({prodList:s})}else alert(_.OUT_OF_STOCK)},D=e=>{const n=document.getElementById("cart-items");if(!n)return;const t=`<span>${e.name} - ${e.price}원 x 1</span><div><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="-1">-</button><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="1">+</button><button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${e.id}">삭제</button></div>`,s=i("div",{id:e.id,className:"flex justify-between items-center mb-2",innerHTML:t});n.appendChild(s),e.quantity--;const o=h.map(c=>c.id===e.id?e:c);E({prodList:o})},G=()=>{const e=document.getElementById("add-to-cart"),n=document.getElementById("product-select");!e||!n||e.addEventListener("click",()=>{const t=n.value,s=h.find(c=>c.id===t);if(!s||s.quantity<=0)return;const o=document.getElementById(s.id);o?F(o,s):D(s),g(),E({lastSelectedItemId:t})})},{getState:P}=l,{prodList:K}=P(),H=(e,n,t,s)=>{if(e>0&&e<=n.quantity+parseInt(t.querySelector("span").textContent.split("x ")[1])){t.querySelector("span").textContent=t.querySelector("span").textContent.split("x ")[0]+"x "+e,n.quantity-=s;return}if(e<=0){t.remove(),n.quantity-=s;return}alert(_.OUT_OF_STOCK)},k=(e,n)=>{const t=parseInt(n.querySelector("span").textContent.split("x ")[1]);e.quantity+=t,n.remove()},Q=()=>{const e=document.getElementById("cart-items");e&&e.addEventListener("click",n=>{const t=n.target;if(!t.classList.contains("quantity-change")&&!t.classList.contains("remove-item"))return;const s=t.dataset.productId,o=document.getElementById(s),c=K.find(r=>r.id===s);if(t.classList.contains("quantity-change")){const r=parseInt(t.dataset.change),a=parseInt(o.querySelector("span").textContent.split("x ")[1])+r;H(a,c,o,r)}t.classList.contains("remove-item")&&k(c,o),g()})},Y=()=>{G(),Q()};let f=null;const{prodList:A}=l.getState(),V=()=>{const e=Math.floor(Math.random()*A.length),n=A[e];B&&n.quantity>0&&(n.price=Math.round(n.price*O.FLASH),alert(`번개세일! ${n.name} 이(가) 20% 할인 중입니다!`))},j=()=>{f?clearInterval(f):setTimeout(()=>{f=setInterval(V,S.FLASH_INTERVAL)},S.FLASH_TIME)};let L=null;const z=()=>{const{prodList:e,lastSelectedItemId:n}=l.getState(),t=n;if(t){const s=e.find(o=>o.id!==t&&o.quantity>0);s&&(alert(`${s.name}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`),s.price=Math.round(s.price*O.SUGGEST))}},J=()=>{L?clearInterval(L):setTimeout(()=>{L=setInterval(z,S.SUGGEST_INTERVAL)},S.SUGGEST_TIME)},W=()=>{j(),J()},X=()=>{const{prodList:e}=l.getState(),n=document.getElementById("product-select");n&&(n.innerHTML="",e.forEach(t=>{const s=i("option",{value:t.id,textContent:`${t.name} - ${t.price}원`,disabled:t.quantity===0});n.appendChild(s)}))},Z=()=>{const e=document.getElementById("app"),n=i("div",{className:"bg-gray-100 p-8"}),t=i("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8"}),s=i("select",{id:"product-select",className:"border rounded p-2 mr-2"}),o=i("button",{id:"add-to-cart",className:"bg-blue-500 text-white px-4 py-2 rounded",textContent:"추가"}),c=i("div",{id:"cart-items"}),r=i("div",{id:"cart-total",className:"text-xl font-bold my-4"}),a=i("div",{id:"stock-status",className:"text-sm text-gray-500 mt-2"}),u=i("h1",{className:"text-2xl font-bold mb-4",textContent:"장바구니"});t.appendChild(u),t.appendChild(c),t.appendChild(r),t.appendChild(s),t.appendChild(o),t.appendChild(a),n.appendChild(t),e.appendChild(n),X(),g()},tt=()=>{Z(),Y(),W()};tt();
